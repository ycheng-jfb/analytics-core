CREATE TRANSIENT TABLE IF NOT EXISTS breakage.jfb_sxf_membership_credit_breakage_report_snapshot (
	business_unit VARCHAR(155),
	brand VARCHAR(155),
	region VARCHAR(2),
	country VARCHAR(155),
	original_credit_tender VARCHAR(4),
	store_credit_reason VARCHAR(155),
	original_credit_type VARCHAR(15),
	issued_month DATE,
	deferred_recognition_label VARCHAR(155),
	currency VARCHAR(55),
	original_issued_amount NUMBER(20,4),
	credit_tenure NUMBER(38,0),
	recognition_booking_month DATE,
	issued_to_date NUMBER(20,4),
	redeemed_to_date NUMBER(20,4),
	cancelled_to_date NUMBER(20,4),
	expired_to_date NUMBER(1,0),
	unredeemed_to_date NUMBER(20,4),
	redeemed_rate_to_date NUMBER(20,4),
	cancelled_to_date_pct NUMBER(20,4),
	unredeemed_to_date_pct NUMBER(20,4),
	expected_redeemed_rate NUMBER(20,4),
	expected_unredeemed_rate NUMBER(20,4),
	expected_redeemed_rate_max NUMBER(20,4),
	actual_redeemed_rate_vs_expected NUMBER(20,4),
	assumption_cumulative_cancelled_pct NUMBER(20,4),
	expected_redeemed NUMBER(20,4),
	expected_additional_redeemed NUMBER(20,4),
	expected_cancelled NUMBER(20,4),
	expected_additional_cancelled NUMBER(20,4),
	expected_unredeemed NUMBER(20,4),
	unredeemed_cant_recognize NUMBER(20,4),
	expected_cannot_recognize NUMBER(20,4),
	expected_breakage NUMBER(20,4),
	breakage_to_record NUMBER(20,4),
	change_in_breakage_to_record NUMBER(20,4),
	breakage_type VARCHAR(17),
	snapshot_timestamp TIMESTAMP_LTZ(9)
);
