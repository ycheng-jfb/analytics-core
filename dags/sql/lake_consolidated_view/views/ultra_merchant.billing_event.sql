CREATE OR REPLACE VIEW LAKE_CONSOLIDATED_VIEW.ULTRA_MERCHANT.BILLING_EVENT  (
	data_source_id,
	meta_company_id,
	billing_event_id,
	billing_processor_id,
	billing_event_type_id,
	order_id,
	membership_id,
	retry_billing_processor_id,
	refund_id,
	foreign_event_id,
	payment_method,
	retry_cycle,
	retry_active,
	consecutive_failed_billing_periods,
	last_billed_period_id,
	error_message,
	datetime_added,
	datetime_modified,
	datetime_billing_failed_since,
	success,
	statuscode,
	meta_original_billing_event_id,
	hvr_is_deleted,
	meta_create_datetime,
	meta_update_datetime
)AS
SELECT
    data_source_id,
	meta_company_id,
	billing_event_id,
	billing_processor_id,
	billing_event_type_id,
	order_id,
	membership_id,
	retry_billing_processor_id,
	refund_id,
	foreign_event_id,
	payment_method,
	retry_cycle,
	retry_active,
	consecutive_failed_billing_periods,
	last_billed_period_id,
	error_message,
	datetime_added,
	datetime_modified,
	datetime_billing_failed_since,
	success,
	statuscode,
	meta_original_billing_event_id,
	hvr_is_deleted,
	meta_create_datetime,
	meta_update_datetime
FROM LAKE_CONSOLIDATED.ULTRA_MERCHANT.BILLING_EVENT
WHERE NVL(hvr_is_deleted, 0) = 0;
