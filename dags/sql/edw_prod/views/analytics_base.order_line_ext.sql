CREATE OR REPLACE VIEW analytics_base.order_line_ext (
         object_type,
         order_line_id,
         meta_original_order_line_id,
         order_id,
         original_order_id,
         placed_date,
         order_completion_date,
         order_shipped_date,
         reship_placed_date,
         exchange_placed_date,
         return_date,
         order_status,
         order_line_status,
         store_id,
         store_name,
         store_full_name,
         store_brand,
         store_type,
         store_region,
         store_country,
         fulfillment_warehouse_id,
         warehouse_code,
         warehouse_name,
         warehouse_type,
         carrier_service,
         pickup_store_id,
         product_id,
         master_product_id,
         sku,
         product_sku,
         base_sku,
         product_name,
         bundle_product_id,
         bundle_alias,
         is_byo_component,
         is_bundle_component,
         is_pre_made_set,
         is_vip_box,
         is_free,
         color,
         size,
         product_gender,
         membership_order_type_l1,
         membership_order_type_l2,
         membership_order_type_l3,
         order_sales_channel_l1,
         order_sales_channel_l2,
         order_classification_l1,
         is_retail_ship_only_order,
         is_bops_order,
         customer_id,
         customer_gender,
         is_cross_promo,
         finance_specialty_store,
         price_sold_as_type,
         first_item_vip_price,
         current_item_vip_price,
         item_vip_price,
         item_retail_price,
         non_reduced_vip_price,
         unit_count,
         reship_unit_count,
         exchange_unit_count,
         finalsales_quantity,
         token_count,
         subtotal_excl_tariff,
         tariff_revenue,
         token_subtotal,
         product_gross_revenue_excl_shipping,
         product_margin_pre_return_excl_shipping,
         product_cost,
         reship_product_cost,
         exchange_product_cost,
         token_product_cost,
         product_discount,
         token_discount,
         return_unit_count,
         return_product_gross_revenue_excl_shipping,
         return_product_cost_returned_resalable,
         meta_row_hash,
         meta_create_datetime,
         meta_update_datetime,
         order_processing_status
            )
AS
SELECT object_type,
       order_line_id,
       meta_original_order_line_id,
       order_id,
       original_order_id,
       placed_date,
       order_completion_date,
       order_shipped_date,
       reship_placed_date,
       exchange_placed_date,
       return_date,
       order_status,
       order_line_status,
       store_id,
       store_name,
       store_full_name,
       store_brand,
       store_type,
       store_region,
       store_country,
       fulfillment_warehouse_id,
       warehouse_code,
       warehouse_name,
       warehouse_type,
       carrier_service,
       pickup_store_id,
       product_id,
       master_product_id,
       sku,
       product_sku,
       base_sku,
       product_name,
       bundle_product_id,
       bundle_alias,
       is_byo_component,
       is_bundle_component,
       is_pre_made_set,
       is_vip_box,
       is_free,
       color,
       size,
       product_gender,
       membership_order_type_l1,
       membership_order_type_l2,
       membership_order_type_l3,
       order_sales_channel_l1,
       order_sales_channel_l2,
       order_classification_l1,
       is_retail_ship_only_order,
       is_bops_order,
       customer_id,
       customer_gender,
       is_cross_promo,
       finance_specialty_store,
       price_sold_as_type,
       first_item_vip_price,
       current_item_vip_price,
       item_vip_price,
       item_retail_price,
       non_reduced_vip_price,
       unit_count,
       reship_unit_count,
       exchange_unit_count,
       finalsales_quantity,
       token_count,
       subtotal_excl_tariff,
       tariff_revenue,
       token_subtotal,
       product_gross_revenue_excl_shipping,
       product_margin_pre_return_excl_shipping,
       product_cost,
       reship_product_cost,
       exchange_product_cost,
       token_product_cost,
       product_discount,
       token_discount,
       return_unit_count,
       return_product_gross_revenue_excl_shipping,
       return_product_cost_returned_resalable,
       meta_row_hash,
       meta_create_datetime,
       meta_update_datetime,
       order_processing_status
FROM analytics_base.order_line_ext_stg
WHERE NOT COALESCE (is_deleted, FALSE);
