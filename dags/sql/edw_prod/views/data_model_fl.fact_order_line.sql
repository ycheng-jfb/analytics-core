CREATE OR REPLACE VIEW data_model_fl.fact_order_line (
    order_line_id,
    order_id,
    store_id,
    customer_id,
    product_id,
    master_product_id,
    bundle_product_id,
    bundle_component_product_id,
    group_code,
    bundle_component_history_key,
    product_type_key,
    bundle_order_line_id,
    order_membership_classification_key,
    order_sales_channel_key,
    order_line_status_key,
    order_status_key,
    order_product_source_key,
    currency_key,
    administrator_id,
    warehouse_id,
    shipping_address_id,
    billing_address_id,
    bounceback_endowment_id,
    cost_source_id,
    cost_source,
    order_local_datetime,
    payment_transaction_local_datetime,
    shipped_local_datetime,
    order_completion_local_datetime,
    order_date_usd_conversion_rate,
    order_date_eur_conversion_rate,
    payment_transaction_date_usd_conversion_rate,
    payment_transaction_date_eur_conversion_rate,
    shipped_date_usd_conversion_rate,
    shipped_date_eur_conversion_rate,
    reporting_usd_conversion_rate,
    reporting_eur_conversion_rate,
    effective_vat_rate,
    item_quantity,
    payment_transaction_local_amount,
    subtotal_excl_tariff_local_amount,
    tariff_revenue_local_amount,
    product_subtotal_local_amount,
    tax_local_amount,
    product_discount_local_amount,
    shipping_cost_local_amount,
    shipping_discount_local_amount,
    shipping_revenue_before_discount_local_amount,
    shipping_revenue_local_amount,
    cash_credit_local_amount,
    cash_membership_credit_local_amount,
    cash_refund_credit_local_amount,
    cash_giftco_credit_local_amount,
    cash_giftcard_credit_local_amount,
    token_count,
    token_local_amount,
    cash_token_count,
    cash_token_local_amount,
    non_cash_token_count,
    non_cash_token_local_amount,
    non_cash_credit_local_amount,
    estimated_landed_cost_local_amount,
    oracle_cost_local_amount,
    lpn_po_cost_local_amount,
    po_cost_local_amount,
    misc_cogs_local_amount,
    estimated_shipping_supplies_cost_local_amount,
    estimated_shipping_cost_local_amount,
    estimated_variable_warehouse_cost_local_amount,
    estimated_variable_gms_cost_local_amount,
    estimated_variable_payment_processing_pct_cash_revenue,
    price_offered_local_amount,
    air_vip_price,
    retail_unit_price,
    bundle_price_offered_local_amount,
    product_price_history_key,
    bundle_product_price_history_key,
    item_price_key,
    amount_to_pay,
    cash_gross_revenue_local_amount,
    product_gross_revenue_local_amount,
    product_gross_revenue_excl_shipping_local_amount,
    product_margin_pre_return_local_amount,
    product_margin_pre_return_excl_shipping_local_amount,
    group_key,
    lpn_code,
    custom_printed_text,
    reporting_landed_cost_local_amount,
    is_actual_landed_cost,
    is_fully_landed,
    fully_landed_conversion_date,
    actual_landed_cost_local_amount,
    actual_po_cost_local_amount,
    actual_cmt_cost_local_amount,
    actual_tariff_duty_cost_local_amount,
    actual_freight_cost_local_amount,
    actual_other_cost_local_amount,
    bounceback_endowment_local_amount,
    vip_endowment_local_amount,
    meta_create_datetime,
    meta_update_datetime
    )
AS
SELECT
    stg.udf_unconcat_brand(order_line_id) AS order_line_id,
    stg.udf_unconcat_brand(order_id) AS order_id,
    store_id,
    stg.udf_unconcat_brand(customer_id) AS customer_id,
    stg.udf_unconcat_brand(product_id) AS product_id,
    stg.udf_unconcat_brand(master_product_id) AS master_product_id,
    stg.udf_unconcat_brand(bundle_product_id) AS bundle_product_id,
    stg.udf_unconcat_brand(bundle_component_product_id) AS bundle_component_product_id,
    group_code,
    bundle_component_history_key,
    product_type_key,
    stg.udf_unconcat_brand(bundle_order_line_id) AS bundle_order_line_id,
    order_membership_classification_key,
    order_sales_channel_key,
    order_line_status_key,
    order_status_key,
    order_product_source_key,
    currency_key,
    administrator_id,
    warehouse_id,
    stg.udf_unconcat_brand(shipping_address_id) AS shipping_address_id,
    stg.udf_unconcat_brand(billing_address_id) AS billing_address_id,
    bounceback_endowment_id,
    cost_source_id,
    cost_source,
    order_local_datetime,
    payment_transaction_local_datetime,
    shipped_local_datetime,
    order_completion_local_datetime,
    order_date_usd_conversion_rate,
    order_date_eur_conversion_rate,
    payment_transaction_date_usd_conversion_rate,
    payment_transaction_date_eur_conversion_rate,
    shipped_date_usd_conversion_rate,
    shipped_date_eur_conversion_rate,
    reporting_usd_conversion_rate,
    reporting_eur_conversion_rate,
    effective_vat_rate,
    item_quantity,
    payment_transaction_local_amount,
    subtotal_excl_tariff_local_amount,
    tariff_revenue_local_amount,
    product_subtotal_local_amount,
    tax_local_amount,
    product_discount_local_amount,
    shipping_cost_local_amount,
    shipping_discount_local_amount,
    shipping_revenue_before_discount_local_amount,
    shipping_revenue_local_amount,
    cash_credit_local_amount,
    cash_membership_credit_local_amount,
    cash_refund_credit_local_amount,
    cash_giftco_credit_local_amount,
    cash_giftcard_credit_local_amount,
    token_count,
    token_local_amount,
    cash_token_count,
    cash_token_local_amount,
    non_cash_token_count,
    non_cash_token_local_amount,
    non_cash_credit_local_amount,
    estimated_landed_cost_local_amount,
    oracle_cost_local_amount,
    lpn_po_cost_local_amount,
    po_cost_local_amount,
    misc_cogs_local_amount,
    estimated_shipping_supplies_cost_local_amount,
    estimated_shipping_cost_local_amount,
    estimated_variable_warehouse_cost_local_amount,
    estimated_variable_gms_cost_local_amount,
    estimated_variable_payment_processing_pct_cash_revenue,
    price_offered_local_amount,
    air_vip_price,
    retail_unit_price,
    bundle_price_offered_local_amount,
    product_price_history_key,
    bundle_product_price_history_key,
    item_price_key,
    amount_to_pay,
    cash_gross_revenue_local_amount,
    product_gross_revenue_local_amount,
    product_gross_revenue_excl_shipping_local_amount,
    product_margin_pre_return_local_amount,
    product_margin_pre_return_excl_shipping_local_amount,
    group_key,
    lpn_code,
    custom_printed_text,
    reporting_landed_cost_local_amount,
    is_actual_landed_cost,
    is_fully_landed,
    fully_landed_conversion_date,
    actual_landed_cost_local_amount,
    actual_po_cost_local_amount,
    actual_cmt_cost_local_amount,
    actual_tariff_duty_cost_local_amount,
    actual_freight_cost_local_amount,
    actual_other_cost_local_amount,
    bounceback_endowment_local_amount,
    vip_endowment_local_amount,
    meta_create_datetime,
    meta_update_datetime
FROM reference.fact_order_line_optimized
WHERE  substring(order_line_id, -2) = '20';
