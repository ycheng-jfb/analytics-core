CREATE OR REPLACE VIEW data_model_3p.amz_fact_order(
    order_id,
    tfg_order_id,
    order_fulfillment_channel_key,
    order_marketplace_channel_key,
    order_status_key,
    store_id,
    buyer_info_buyer_email,
    purchase_local_datetime,
    shipped_local_datetime,
    posted_local_date,
    settlement_id,
    settled_local_datetime,
    quantity_ordered,
    quantity_shipped,
    item_price_local_amount,
    usd_conversion_rate,
    item_tax_local_amount,
    shipping_price_local_amount,
    shipping_tax_local_amount,
    shipping_discount_local_amount,
    shipping_discount_tax_local_amount,
    promotion_discount_local_amount,
    promotion_discount_tax_local_amount,
    meta_create_datetime,
    meta_update_datetime
)AS
       (
SELECT order_id,
       tfg_order_id,
       order_fulfillment_channel_key,
       order_marketplace_channel_key,
       order_status_key,
       store_id,
       buyer_info_buyer_email,
       purchase_local_datetime,
       shipped_local_datetime,
       posted_local_date,
       settlement_id,
       settled_local_datetime,
       quantity_ordered,
       quantity_shipped,
       item_price_local_amount,
       usd_conversion_rate,
       item_tax_local_amount,
       shipping_price_local_amount,
       shipping_tax_local_amount,
       shipping_discount_local_amount,
       shipping_discount_tax_local_amount,
       promotion_discount_local_amount,
       promotion_discount_tax_local_amount,
       meta_create_datetime,
       meta_update_datetime
FROM dbt_edw_prod.stg.amz_fact_order
);
