CREATE OR REPLACE VIEW data_model_3p.amz_fact_order_line(
    order_line_id,
    order_id,
    tfg_order_id,
    tfg_order_line_id,
    tfg_product_id,
    tfg_master_product_id,
    order_fulfillment_channel_key,
    order_marketplace_channel_key,
    order_status_key,
    store_id,
    buyer_info_buyer_email,
    purchase_local_datetime,
    shipped_local_datetime,
    posted_local_date,
    settlement_id,
    settled_local_datetime,
    buyer_order_rank,
    order_type_key,
    item_price_currency_code,
    product_key,
    quantity_ordered,
    quantity_shipped,
    item_price_local_amount,
    usd_conversion_rate,
    item_tax_local_amount,
    shipping_price_local_amount,
    shipping_tax_local_amount,
    shipping_discount_local_amount,
    shipping_discount_tax_local_amount,
    promotion_discount_local_amount,
    promotion_discount_tax_local_amount,
    meta_row_hash,
    meta_create_datetime,
    meta_update_datetime
)
AS
(
    SELECT order_line_id,
           order_id,
           tfg_order_id,
           tfg_order_line_id,
           tfg_product_id,
           tfg_master_product_id,
           order_fulfillment_channel_key,
           order_marketplace_channel_key,
           order_status_key,
           store_id,
           buyer_info_buyer_email,
           purchase_local_datetime,
           shipped_local_datetime,
           posted_local_date,
           settlement_id,
           settled_local_datetime,
           buyer_order_rank,
           order_type_key,
           item_price_currency_code,
           product_key,
           quantity_ordered,
           quantity_shipped,
           item_price_local_amount,
           usd_conversion_rate,
           item_tax_local_amount,
           shipping_price_local_amount,
           shipping_tax_local_amount,
           shipping_discount_local_amount,
           shipping_discount_tax_local_amount,
           promotion_discount_local_amount,
           promotion_discount_tax_local_amount,
           meta_row_hash,
           meta_create_datetime,
           meta_update_datetime
FROM dbt_edw_prod.stg.amz_fact_order_line
);
