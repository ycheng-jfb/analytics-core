CREATE OR REPLACE VIEW  data_model_sxf.fact_order_line_product_cost
(
    order_line_id,
    currency_key,
    store_id,
    order_id,
    shipped_local_datetime,
    order_completion_local_datetime,
    brand,
    sku,
    style_color,
    product_category,
    department,
    category,
    subcategory,
    class,
    receipt_po,
    receipt_po_line_number,
    receipt_year_month,
    alternate_po,
    alternate_po_line_number,
    alternate_year_month,
    receipt_datetime,
    alternate_receipt_datetime,
    is_lpn_found,
    is_po_receipt_found,
    is_deleted,
    calculation_type,
    is_fully_landed,
    reporting_landed_cost_local_amount,
    is_actual_landed_cost,
    fully_landed_conversion_date,
    estimated_landed_cost_local_amount,
    actual_landed_cost_local_amount,
    actual_po_cost_local_amount,
    actual_cmt_cost_local_amount,
    actual_tariff_duty_cost_local_amount,
    actual_freight_cost_local_amount,
    actual_other_cost_local_amount,
    meta_create_datetime,
    meta_update_datetime
) AS
SELECT
    stg.udf_unconcat_brand(order_line_id) AS order_line_id,
    currency_key,
    store_id,
    stg.udf_unconcat_brand(order_id) AS order_id,
    shipped_local_datetime,
    order_completion_local_datetime,
    brand,
    sku,
    style_color,
    product_category,
    department,
    category,
    subcategory,
    class,
    receipt_po,
    receipt_po_line_number,
    receipt_year_month,
    alternate_po,
    alternate_po_line_number,
    alternate_year_month,
    receipt_datetime,
    alternate_receipt_datetime,
    is_lpn_found,
    is_po_receipt_found,
    is_deleted,
    calculation_type,
    is_fully_landed,
    reporting_landed_cost_local_amount,
    is_actual_landed_cost,
    fully_landed_conversion_date,
    estimated_landed_cost_local_amount,
    actual_landed_cost_local_amount,
    actual_po_cost_local_amount,
    actual_cmt_cost_local_amount,
    actual_tariff_duty_cost_local_amount,
    actual_freight_cost_local_amount,
    actual_other_cost_local_amount,
    meta_create_datetime,
    meta_update_datetime
FROM stg.fact_order_line_product_cost
WHERE substring(order_line_id, -2) = '30';
