CREATE OR REPLACE VIEW data_model_fl.dim_promo_history
        (
         promo_history_key,
         promo_id,
         promo_name,
         first_promo_code,
         promo_code,
         promo_description,
         promo_type,
         promo_cms_type,
         promo_cms_description,
         promo_classification,
         discount_method,
         subtotal_discount,
         shipping_discount,
         promo_status_code,
         promo_status,
         promo_start_datetime,
         promo_end_datetime,
         promo_store_applied,
         required_product_quantity,
         min_product_quantity,
         fpl_included,
         fpl_excluded,
         fpl_required,
         category_included,
         category_excluded,
         category_required,
         promo_name_cms,
         membership_choice,
         registration_date_option,
         registration_exact_date,
         registration_start_date,
         registration_end_date,
         registration_day,
         registration_day_start,
         registration_day_end,
         gender_selected,
         membership_reward_multiplier,
         is_deleted,
         effective_start_datetime,
         effective_end_datetime,
         is_current,
         meta_create_datetime,
         meta_update_datetime
            )
AS
SELECT promo_history_key,
       edw_prod.stg.udf_unconcat_brand(promo_id),
       promo_name,
       first_promo_code,
       promo_code,
       promo_description,
       promo_type,
       promo_cms_type,
       promo_cms_description,
       promo_classification,
       discount_method,
       subtotal_discount,
       shipping_discount,
       promo_status_code,
       promo_status,
       promo_start_datetime,
       promo_end_datetime,
       promo_store_applied,
       required_product_quantity,
       min_product_quantity,
       fpl_included,
       fpl_excluded,
       fpl_required,
       category_included,
       category_excluded,
       category_required,
       promo_name_cms,
       membership_choice,
       registration_date_option,
       registration_exact_date,
       registration_start_date,
       registration_end_date,
       registration_day,
       registration_day_start,
       registration_day_end,
       gender_selected,
       membership_reward_multiplier,
       is_deleted,
       effective_start_datetime,
       effective_end_datetime,
       is_current,
       meta_create_datetime,
       meta_update_datetime
FROM stg.dim_promo_history
WHERE SUBSTRING(promo_id, -2) = '20' OR promo_id = -1;
