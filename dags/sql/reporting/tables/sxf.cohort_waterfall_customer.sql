CREATE TRANSIENT TABLE IF NOT EXISTS reporting.sxf.cohort_waterfall_customer (
    customer_id NUMBER(38,0),
	vip_cohort_month_date DATE,
	membership_type VARCHAR(100),
	month_date DATE,
	membership_monthly_status VARCHAR(50),
	store_brand VARCHAR(50),
	store_region VARCHAR(50),
	store_country VARCHAR(50),
	store_name VARCHAR(50),
    activation_store_type VARCHAR(50),
    activation_store_full_name VARCHAR(50),
    omni_channel VARCHAR(50),
    membership_sequence VARCHAR(50),
    repeat_purchaser VARCHAR(50),
	activating_product_order_unit_count NUMBER(38,0),
	activating_product_order_count NUMBER(38,0),
	activating_product_order_product_discount_amount NUMBER(38,4),
	activating_product_order_subtotal_excl_tariff_amount NUMBER(38,4),
	activating_product_order_shipping_revenue_amount NUMBER(38,4),
    activating_product_gross_revenue NUMBER(38,4),
    activating_product_order_landed_product_cost_amount NUMBER(38,4),
	nonactivating_product_order_unit_count NUMBER(38,0),
	nonactivating_product_order_count NUMBER(38,0),
	nonactivating_product_order_product_discount_amount NUMBER(38,4),
	nonactivating_product_order_subtotal_excl_tariff_amount NUMBER(38,4),
	nonactivating_product_order_shipping_revenue_amount NUMBER(38,4),
    nonactivating_product_gross_revenue NUMBER(38,4),
    nonactivating_product_order_landed_product_cost_amount NUMBER(38,4),
	vip_cancellation_count NUMBER(38,0),
	bop_vip_count NUMBER(38,0),
	activation_count NUMBER(38,0),
	failed_billing_count NUMBER(38,0),
	merch_purchase_count NUMBER(38,0),
	purchase_count NUMBER(38,0),
	reactivation_count NUMBER(38,0),
	skip_count NUMBER(38,0),
	vip_passive_cancellation_count NUMBER(38,0),
	is_successful_billing_count NUMBER(38,0),
	online_product_order_count NUMBER(38,0),
	retail_product_order_count NUMBER(38,0),
	mobile_app_product_order_count NUMBER(38,0),
	online_product_order_unit_count NUMBER(38,0),
	retail_product_order_unit_count NUMBER(38,0),
	mobile_app_product_order_unit_count NUMBER(38,0),
	online_product_order_subtotal_excl_tariff_amount NUMBER(38,4),
	retail_product_order_subtotal_excl_tariff_amount NUMBER(38,4),
	mobile_app_product_order_subtotal_excl_tariff_amount NUMBER(38,4),
	online_product_order_product_discount_amount NUMBER(38,4),
	retail_product_order_product_discount_amount NUMBER(38,4),
	mobile_app_product_order_product_discount_amount NUMBER(38,4),
	online_product_order_shipping_revenue_amount NUMBER(38,4),
	retail_product_order_shipping_revenue_amount NUMBER(38,4),
	mobile_app_product_order_shipping_revenue_amount NUMBER(38,4),
	product_order_direct_cogs_amount NUMBER(38,4),
	online_product_order_direct_cogs_amount NUMBER(38,4),
	retail_product_order_direct_cogs_amount NUMBER(38,4),
	mobile_app_product_order_direct_cogs_amount NUMBER(38,4),
	product_order_selling_expenses_amount NUMBER(38,4),
	online_product_order_selling_expenses_amount NUMBER(38,4),
	retail_product_order_selling_expenses_amount NUMBER(38,4),
	mobile_app_product_order_selling_expenses_amount NUMBER(38,4),
	product_order_cash_refund_amount_and_chargeback_amount NUMBER(38,4),
	online_product_order_cash_refund_chargeback_amount NUMBER(38,4),
	retail_product_order_cash_refund_chargeback_amount NUMBER(38,4),
	mobile_app_product_order_cash_refund_chargeback_amount NUMBER(38,4),
	product_order_cash_credit_refund_amount NUMBER(38,4),
	online_product_order_cash_credit_refund_amount NUMBER(38,4),
	retail_product_order_cash_credit_refund_amount NUMBER(38,4),
	mobile_app_product_order_cash_credit_refund_amount NUMBER(38,4),
	product_order_reship_exchange_order_count NUMBER(38,0),
	online_product_order_reship_exchange_order_count NUMBER(38,0),
	retail_product_order_reship_exchange_order_count NUMBER(38,0),
	mobile_app_product_order_reship_exchange_order_count NUMBER(38,0),
	product_order_reship_exchange_unit_count NUMBER(38,0),
	online_product_order_reship_exchange_unit_count NUMBER(38,0),
	retail_product_order_reship_exchange_unit_count NUMBER(38,0),
	mobile_app_product_order_reship_exchange_unit_count NUMBER(38,0),
	product_order_reship_exchange_direct_cogs_amount NUMBER(38,4),
	online_product_order_reship_exchange_direct_cogs_amount NUMBER(38,4),
	retail_product_order_reship_exchange_direct_cogs_amount NUMBER(38,4),
	mobile_app_product_order_reship_exchange_direct_cogs_amount NUMBER(38,4),
	product_order_return_cogs_amount NUMBER(38,4),
	online_product_order_return_cogs_amount NUMBER(38,4),
	retail_product_order_return_cogs_amount NUMBER(38,4),
	mobile_app_product_order_return_cogs_amount NUMBER(38,4),
	product_order_return_unit_count NUMBER(38,0),
	online_product_order_return_unit_count NUMBER(38,0),
	retail_product_order_return_unit_count NUMBER(38,0),
	mobile_app_product_order_return_unit_count NUMBER(38,0),
	product_order_amount_to_pay NUMBER(38,4),
	online_product_order_amount_to_pay NUMBER(38,4),
	retail_product_order_amount_to_pay NUMBER(38,4),
	mobile_app_product_order_amount_to_pay NUMBER(38,4),
	product_gross_revenue_excl_shipping NUMBER(38,4),
	online_product_gross_revenue_excl_shipping NUMBER(38,4),
	retail_product_gross_revenue_excl_shipping NUMBER(38,4),
	mobile_app_product_gross_revenue_excl_shipping NUMBER(38,4),
	product_gross_revenue NUMBER(38,4),
	online_product_gross_revenue NUMBER(38,4),
	retail_product_gross_revenue NUMBER(38,4),
	mobile_app_product_gross_revenue NUMBER(38,4),
	product_net_revenue NUMBER(38,4),
	online_product_net_revenue NUMBER(38,4),
	retail_product_net_revenue NUMBER(38,4),
	mobile_app_product_net_revenue NUMBER(38,4),
	product_margin_pre_return NUMBER(38,4),
	online_product_margin_pre_return NUMBER(38,4),
	retail_product_margin_pre_return NUMBER(38,4),
	product_margin_pre_return_excl_shipping NUMBER(38,4),
	online_product_margin_pre_return_excl_shipping NUMBER(38,4),
	retail_product_margin_pre_return_excl_shipping NUMBER(38,4),
	product_gross_profit NUMBER(38,4),
	online_product_gross_profit NUMBER(38,4),
	retail_product_gross_profit NUMBER(38,4),
	mobile_app_product_gross_profit NUMBER(38,4),
	product_variable_contribution_profit NUMBER(38,4),
	online_product_variable_contribution_profit NUMBER(38,4),
	retail_product_variable_contribution_profit NUMBER(38,4),
	mobile_app_product_variable_contribution_profit NUMBER(38,4),
	product_order_cash_gross_revenue_amount NUMBER(38,4),
	online_product_order_cash_gross_revenue_amount NUMBER(38,4),
	retail_product_order_cash_gross_revenue_amount NUMBER(38,4),
	mobile_app_product_order_cash_gross_revenue_amount NUMBER(38,4),
	product_order_cash_net_revenue NUMBER(38,4),
	online_product_order_cash_net_revenue NUMBER(38,4),
	retail_product_order_cash_net_revenue NUMBER(38,4),
	mobile_app_product_order_cash_net_revenue NUMBER(38,4),
	billing_cash_gross_revenue NUMBER(38,4),
	billing_cash_net_revenue NUMBER(38,4),
	cash_gross_revenue NUMBER(38,4),
	cash_net_revenue NUMBER(38,4),
	cash_gross_profit NUMBER(38,4),
	cash_variable_contribution_profit NUMBER(38,4),
	monthly_billed_credit_cash_transaction_amount NUMBER(38,4),
	membership_fee_cash_transaction_amount NUMBER(38,4),
	gift_card_transaction_amount NUMBER(38,4),
	legacy_credit_cash_transaction_amount NUMBER(38,4),
	monthly_billed_credit_cash_refund_chargeback_amount NUMBER(38,4),
	membership_fee_cash_refund_chargeback_amount NUMBER(38,4),
	gift_card_cash_refund_chargeback_amount NUMBER(38,4),
	legacy_credit_cash_refund_chargeback_amount NUMBER(38,4),
	cumulative_cash_gross_profit NUMBER(38,4),
	cumulative_product_gross_profit NUMBER(38,4),
	cumulative_cash_gross_profit_decile NUMBER(38,0),
	cumulative_product_gross_profit_decile NUMBER(38,0),
	billed_cash_credit_cancelled_equivalent_count NUMBER(38,0),
	billed_cash_credit_redeemed_equivalent_count NUMBER(38,0),
	media_spend NUMBER(38,4),
    cumulative_total_emp_opt_in NUMBER(38,4),
    cumulative_active_emp_opt_in NUMBER(38,4),
    total_emp_opt_in NUMBER(38,4),
    order_count_with_credit_redemption NUMBER(38,4),
    meta_create_datetime TIMESTAMP_LTZ(3),
    meta_update_datetime TIMESTAMP_LTZ(3)
);
