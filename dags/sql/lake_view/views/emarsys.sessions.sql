CREATE VIEW IF NOT EXISTS LAKE_VIEW.EMARSYS.SESSIONS AS
SELECT csm.store_group,
    s.START_TIME,
	s.END_TIME,
	s.PURCHASES,
	s.PURCHASES_EVENT_TIME,
	s.PURCHASES_ITEMS,
	s.PURCHASES_ITEMS_ITEM_ID,
	s.PURCHASES_ITEMS_PRICE,
	s.PURCHASES_ITEMS_QUANTITY,
	s.PURCHASES_ORDER_ID,
	s.VIEWS,
	s.VIEWS_EVENT_TIME,
	s.VIEWS_ITEM_ID,
	s.TAGS,
	s.TAGS_EVENT_TIME,
	s.TAGS_TAG,
	s.TAGS_ATTRIBUTES,
	s.TAGS_ATTRIBUTES_NAME,
	s.TAGS_ATTRIBUTES_STRING_VALUE,
	s.TAGS_ATTRIBUTES_NUMBER_VALUE,
	s.TAGS_ATTRIBUTES_BOOLEAN_VALUE,
	s.CATEGORIES,
	s.CATEGORIES_EVENT_TIME,
	s.CATEGORIES_CATEGORY,
	s.LAST_CART,
	s.LAST_CART_EVENT_TIME,
	s.LAST_CART_ITEMS,
	s.LAST_CART_ITEMS_ITEM_ID,
	s.LAST_CART_ITEMS_PRICE,
	s.LAST_CART_ITEMS_QUANTITY,
	s.USER_ID,
	s.USER_ID_TYPE,
	s.USER_ID_FIELD_ID,
	s.CONTACT_ID,
	s.CURRENCY,
	s.CUSTOMER_ID,
	s.LOADED_AT,
	s.META_CREATE_DATETIME
FROM LAKE.EMARSYS.SESSIONS s
JOIN lake.emarsys.customer_store_mapping csm on csm.customer_id = s.customer_id;
