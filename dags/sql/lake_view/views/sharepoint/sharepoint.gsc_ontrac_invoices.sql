CREATE OR REPLACE VIEW LAKE_VIEW.SHAREPOINT.GSC_ONTRAC_INVOICES AS
SELECT 'ONTRAC' AS SOURCE,
    SOURCE_NAME AS INVOICE_NUMBER,
	COLUMN_1 AS RECORD_TYPE,
	COLUMN_2 AS REFERENCE,
	IFF(length(SPLIT_PART(COLUMN_3, '/', 3)) = 2, try_to_date(COLUMN_3,'MM/DD/YY'),try_to_date(COLUMN_3)) AS INVOICE_DATE,
	COLUMN_4 AS TOTAL_PACKAGE_COST,
	COLUMN_5 AS INVOICE_TRACKING_NUMBER,
	COLUMN_6 AS SHIP_FROM_COMP,
	COLUMN_7 AS SHIP_FROM_NAME,
	COLUMN_8 AS SHIP_FROM_ADDR1,
	COLUMN_9 AS SHIP_FROM_CITY,
	COLUMN_10 AS SHIP_FROM_STATE,
	COLUMN_11 AS SHIP_FROM_ZIP,
	COLUMN_12 AS SHIP_FROM_COUNTRY,
	COLUMN_13 AS SHIP_TO_COMP,
	COLUMN_14 AS SHIP_TO_NAME,
	COLUMN_15 AS SHIP_TO_ADDR1,
	COLUMN_16 AS SHIP_TO_CITY,
	COLUMN_17 AS SHIP_TO_STATE,
	COLUMN_18 AS SHIP_TO_ZIP,
	COLUMN_19 AS SHIP_TO_COUNTRY,
	COLUMN_20 AS SERVICE,
	COLUMN_21 AS CHARGEABLE_WEIGHT,
	COLUMN_22 AS LETTER,
	COLUMN_23 AS POD_SIGNATURE,
	COLUMN_24 AS DEL_DATE,
	COLUMN_25 AS DEL_TIME,
	COLUMN_26 AS SERVICE_CHARGE,
	COLUMN_27 AS COD_CHARGE,
	COLUMN_28 AS DECLARED_VALUE_CHARGE,
	COLUMN_29 AS ADDITIONAL_CHARGE1,
	COLUMN_30 AS ADDITIONAL_CHARGE2,
	COLUMN_31 AS ACCOUNT_NUMBER,
	COLUMN_32 AS WEEKEND_SURCHARGE,
	COLUMN_33 AS FUEL_SURCHARGE,
	COLUMN_34 AS THIRD_PARTY_ACCOUNT_NUMBER,
	COLUMN_35 AS ADDITIONAL_CHARGE3,
	COLUMN_36 AS REFERENCE2,
	COLUMN_37 AS ADDRESS_CORRECTION_SURCHARGE,
	COLUMN_38 AS HARD_COPY_FEE,
	COLUMN_39 AS OVERSIZE_SURCHARGE,
	COLUMN_40 AS NO_RELEASE,
	COLUMN_41 AS RESIDENTIAL_SURCHARGE,
	COLUMN_42 AS DAS_SURCHARGE,
	COLUMN_43 AS ADDITIONAL_HANDLING_SURCHARGE,
	COLUMN_44 AS INVOICE_ZONE,
	COLUMN_45 AS RESI_SIG,
	COLUMN_46 AS CUST_TRACKING,
	COLUMN_47 AS PACKAGE_LENGTH,
	COLUMN_48 AS PACKAGE_WIDTH,
	COLUMN_49 AS PACKAGE_HEIGHT,
	COLUMN_50 AS DIM_POUNDS,
	COLUMN_51 AS INVOICE_ACTUAL_WEIGHT,
	COLUMN_52 AS IRREGULAR_SURCHARGE,
	COLUMN_53 AS PEAK_SEASON_OVERSIZE_SURCHARGE,
	COLUMN_54 AS PEAK_SEASON_RESIDENTIAL_SURCHARGE,
	COLUMN_55 AS EDAS_SURCHARGE,
	COLUMN_56 AS UNAUTHORIZED_PACKAGE,
	COLUMN_57 AS REBILL,
	COLUMN_58 AS PEAK_SEASON_HANDLING_SURCHARGE,
	COLUMN_59 AS RESERVED,
	_modified AS meta_update_datetime,
	_file AS file_name
FROM lake_fivetran.global_apps_gsc_secondary_ingestions.ontrac_invoices_v_1
WHERE _file <> 'OT META DATA FILE.csv';


