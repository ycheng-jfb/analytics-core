CREATE VIEW IF NOT EXISTS LAKE_VIEW.EMARSYS.EMAIL_OPENS AS
SELECT
    csm.store_group,
    s.CAMPAIGN_ID,
	s.CAMPAIGN_TYPE,
	s.CONTACT_ID,
	s.CUSTOMER_ID,
	s.DOMAIN,
	s.EMAIL_SENT_AT,
	s.EVENT_TIME,
	s.GENERATED_FROM,
	s.GEO,
	s.GEO_COUNTRY_ISO_CODE,
	s.GEO_ACCURACY_RADIUS,
	s.GEO_CITY_NAME,
	s.GEO_CONTINENT_CODE,
	s.GEO_LATITUDE,
	s.GEO_LONGITUDE,
	s.GEO_POSTAL_CODE,
	s.GEO_TIME_ZONE,
	s.IP,
	s.IS_ANONYMIZED,
	s.IS_MOBILE,
	s.LAUNCH_ID,
	s.LOADED_AT,
	s.MD5,
	s.MESSAGE_ID,
	s.PLATFORM,
	s.UID,
	s.USER_AGENT,
	s.META_CREATE_DATETIME
FROM LAKE.EMARSYS.EMAIL_OPENS s
JOIN lake.emarsys.customer_store_mapping csm on csm.customer_id = s.customer_id;
