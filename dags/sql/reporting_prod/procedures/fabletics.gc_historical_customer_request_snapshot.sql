SET execution_start_time = CURRENT_TIMESTAMP::TIMESTAMP_LTZ(3);

INSERT INTO fabletics.gc_historical_customer_request_snapshot(
       customer_segment,
       brand,
       vip_cohort,
       payment_date,
       billing_type,
       store_region,
       customer_count,
       cash_gross_revenue,
       cash_net_rev,
       cash_margin_pre_return,
       cash_gross_profit,
       product_order_cash_refund_amount,
       product_order_cash_chargeback_amount,
       billing_cash_refund_amount,
       billing_cash_chargeback_amount,
       product_order_landed_product_cost_amount,
       product_order_exchange_product_cost_amount,
       product_order_reship_product_cost_amount,
       product_order_shipping_cost_amount,
       product_order_reship_shipping_cost_amount,
       product_order_exchange_shipping_cost_amount,
       product_order_return_shipping_cost_amount,
       product_order_shipping_supplies_cost_amount,
       product_order_exchange_shipping_supplies_cost_amount,
       product_order_reship_shipping_supplies_cost_amount,
       product_order_misc_cogs_amount,
       product_order_cost_product_returned_resaleable_amount,
       product_order_variable_gms_cost_amount,
       billing_variable_gms_cost_amount,
       product_order_payment_processing_cost_amount,
       billing_payment_processing_cost_amount,
       product_order_variable_warehouse_cost_amount,
       selling_expenses,
       gfc_fixed,
       gfc_back_office,
       gms_fixed,
       gms_back_office,
       snapshot_datetime)
select customer_segment,
       brand,
       vip_cohort,
       payment_date,
       billing_type,
       store_region,
       customer_count,
       cash_gross_revenue,
       cash_net_rev,
       cash_margin_pre_return,
       cash_gross_profit,
       product_order_cash_refund_amount,
       product_order_cash_chargeback_amount,
       billing_cash_refund_amount,
       billing_cash_chargeback_amount,
       product_order_landed_product_cost_amount,
       product_order_exchange_product_cost_amount,
       product_order_reship_product_cost_amount,
       product_order_shipping_cost_amount,
       product_order_reship_shipping_cost_amount,
       product_order_exchange_shipping_cost_amount,
       product_order_return_shipping_cost_amount,
       product_order_shipping_supplies_cost_amount,
       product_order_exchange_shipping_supplies_cost_amount,
       product_order_reship_shipping_supplies_cost_amount,
       product_order_misc_cogs_amount,
       product_order_cost_product_returned_resaleable_amount,
       product_order_variable_gms_cost_amount,
       billing_variable_gms_cost_amount,
       product_order_payment_processing_cost_amount,
       billing_payment_processing_cost_amount,
       product_order_variable_warehouse_cost_amount,
       selling_expenses,
       gfc_fixed,
       gfc_back_office,
       gms_fixed,
       gms_back_office,
       $execution_start_time
from fabletics.gc_historical_customer_request;


